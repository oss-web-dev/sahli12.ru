$(function(){var u=$(".feedback-form"),r=u.find(".feedback-message"),a=u.find('button[type="submit"]'),c=u.find("#need_answer"),i=u.find(".phone-block"),o=u.find("#phone"),m=u.find("#formFile");if(u.length===0){console.error("\u0424\u043E\u0440\u043C\u0430 .feedback-form \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430!");return}function s(){c.is(":checked")?(i.slideDown(),o.prop("required",!0)):(i.slideUp(),o.prop("required",!1),o.val(""))}s(),c.on("change",s),u.on("submit",function(v){v.preventDefault();var t=u.get(0);if(!t.checkValidity()){t.reportValidity();return}r.text("").removeClass("text-success text-danger"),a.prop("disabled",!0).text("\u041E\u0442\u043F\u0440\u0430\u0432\u043A\u0430...");var d=16777216,l=m.get(0).files;if(l.length>0){var n=l[0];if(n.size>d){var F=(n.size/1024/1024).toFixed(2),x=(d/1024/1024).toFixed(0),f='\u041E\u0448\u0438\u0431\u043A\u0430: \u0424\u0430\u0439\u043B "'.concat(n.name,'" \u0441\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0439 (').concat(F," \u041C\u0411). \u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0440\u0430\u0437\u043C\u0435\u0440: ").concat(x," \u041C\u0411.");alert(f),console.warn(f),a.prop("disabled",!1).text("\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C");return}}var h=new FormData(t);$.ajax({url:u.attr("action"),method:u.attr("method"),data:h,processData:!1,contentType:!1,dataType:"json",success:function(e){console.log("Success:",e),r.text("\u0421\u043F\u0430\u0441\u0438\u0431\u043E! \u0412\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E.").addClass("text-success"),t.reset(),$(".feedback-form").hide(),$(".message-block").html(e.message).show(),s()},error:function(e,b,g){console.error("AJAX Error:",b,g,e.responseText);var E="\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u043E\u0437\u0436\u0435.";e.statusText&&(E="\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438: ".concat(e.statusText,". \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u043E\u0437\u0436\u0435.")),e.responseText,r.text(E).addClass("text-danger")},complete:function(){a.prop("disabled",!1).text("\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C")}})})});
